<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>System Alert</title>
<style>
  :root{--bg:#050505;--accent1:#ff4d4d;--accent2:#ffb3b3;--muted:#cfcfcf}
  html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#111}
  /* Overlay */
  #hacked {
    position:fixed; inset:0; background:var(--bg); color:var(--accent1);
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    z-index:9999; text-align:center; padding:20px;
  }
  h1{font-size:56px; margin:0 0 6px; letter-spacing:6px; color:var(--accent1)}
  p#sub{margin:6px 0 18px; font-size:18px; color:var(--muted)}
  .bar{width:80%; max-width:760px; background:#222; height:16px; border-radius:10px; overflow:hidden;}
  .fill{height:100%; width:0%; background:linear-gradient(90deg,var(--accent1),var(--accent2)); transition:width .9s linear;}
  @keyframes flicker {0%{opacity:1}50%{opacity:.94}100%{opacity:1}}
  #hacked h1{animation:flicker 1s infinite;}
  /* Normal content (after prank) */
  #site {display:none;padding:32px;text-align:center;}
  /* Warning modal (when back pressed) */
  #warnModal {
    position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
    background:#fff; color:#111; padding:18px 20px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,.45);
    z-index:10010; max-width:92%; width:420px; display:none;
  }
  #warnModal h3{margin:0 0 8px}
  #warnModal p{margin:0 0 14px; color:#333}
  .row{display:flex; gap:10px; justify-content:center}
  .btn {padding:10px 14px; border-radius:8px; border:none; cursor:pointer; font-weight:700}
  .btn-stay{background:#111;color:#fff}
  .btn-leave{background:var(--accent1); color:#fff}
  /* small hint for escape (invisible mostly) */
  #esc-hint { position: fixed; right:8px; top:8px; font-size:11px; color:#777; opacity:0.01; z-index:10011 }
</style>
</head>
<body>

<div id="esc-hint" aria-hidden="true">Press ESC to exit</div>

<!-- HACKED overlay -->
<div id="hacked" role="dialog" aria-live="assertive" aria-label="System warning">
  <h1>⚠️ SYSTEM WARNING ⚠️</h1>
  <p id="sub">Critical breach detected... initiating lockdown sequence...</p>
  <div class="bar" aria-hidden="true"><div class="fill" id="fill"></div></div>
</div>

<!-- Warning modal shown when user attempts to navigate back -->
<div id="warnModal" role="alertdialog" aria-hidden="true">
  <h3>Wait — process still running</h3>
  <p>Security scan in progress (5 minutes). Do you want to leave now or stay?</p>
  <div class="row">
    <button class="btn btn-stay" id="stayBtn">Stay (Continue)</button>
    <button class="btn btn-leave" id="leaveBtn">Leave (Exit)</button>
  </div>
</div>

<!-- Normal site content -->
<div id="site">
  <h2>System Restored</h2>
  <p>All processes completed successfully.</p>
</div>

<script>
(function(){
  const DURATION = 300; // 5 minutes
  const fill = document.getElementById('fill');
  const hacked = document.getElementById('hacked');
  const site = document.getElementById('site');
  const sub = document.getElementById('sub');
  const warnModal = document.getElementById('warnModal');
  const stayBtn = document.getElementById('stayBtn');
  const leaveBtn = document.getElementById('leaveBtn');

  let elapsed = 0;
  let timer = null;
  let allowExit = false;

  function startTimer(){
    timer = setInterval(() => {
      elapsed++;
      const pct = Math.min(100, Math.round((elapsed/DURATION)*100));
      fill.style.width = pct + '%';
      if(elapsed === 8) sub.textContent = "Alerting security team...";
      if(elapsed === 60) sub.textContent = "Analyzing system memory...";
      if(elapsed === 180) sub.textContent = "Encrypting logs...";
      if(elapsed === 240) sub.textContent = "Finalizing lockdown...";
      if(elapsed >= DURATION) finish();
    },1000);
  }

  function finish(){
    clearInterval(timer);
    hacked.style.display = 'none';
    site.style.display = 'block';
    fill.style.width = '0%';
    allowExit = true;
    // remove handlers so leaving works normally
    window.removeEventListener('popstate', onPopState);
    window.removeEventListener('beforeunload', onBeforeUnload);
  }

  startTimer();

  // create history entries so Back triggers popstate
  try {
    history.replaceState({prank:'start'}, '', '#prankstart');
    history.pushState({prank:'1'}, '', '#prank1');
    history.pushState({prank:'2'}, '', '#prank2');
  } catch(e){}

  function showModal(){
    warnModal.style.display = 'block';
    warnModal.setAttribute('aria-hidden','false');
  }
  function hideModal(){
    warnModal.style.display = 'none';
    warnModal.setAttribute('aria-hidden','true');
  }

  function onPopState(e){
    if(allowExit) return;
    showModal();
    try { history.pushState({prank:'stay'}, '', '#stay'); } catch(e){}
  }

  function onBeforeUnload(e){
    if(allowExit) return;
    e.preventDefault();
    e.returnValue = '';
    return '';
  }

  window.addEventListener('popstate', onPopState);
  window.addEventListener('beforeunload', onBeforeUnload);

  stayBtn.addEventListener('click', () => { hideModal(); });
  leaveBtn.addEventListener('click', () => {
    allowExit = true;
    hideModal();
    window.removeEventListener('popstate', onPopState);
    window.removeEventListener('beforeunload', onBeforeUnload);
    try { history.back(); } catch(e){}
  });

  // ESC quick exit
  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape' || e.key === 'Esc'){ finish(); }
  });

  // mobile-friendly double-tap on hint to exit (very small invisible hint)
  const escHint = document.getElementById('esc-hint');
  let cornerTaps = 0;
  escHint.addEventListener('click', () => {
    cornerTaps++;
    if(cornerTaps >= 2){ finish(); }
    setTimeout(()=> cornerTaps = 0, 1600);
  });

})();
</script>

</body>
</html>
